
if [ ".$PLATFORM" = "." ]; then
    echo "checking for OS"

    SYSTEM=`uname -s 2>/dev/null`
    RELEASE=`uname -r 2>/dev/null`
    MACHINE=`uname -m 2>/dev/null`

    echo " + $SYSTEM $RELEASE $MACHINE"

    PLATFORM="$SYSTEM:$RELEASE:$MACHINE";
else
    echo "building for $PLATFORM"
fi

case $PLATFORM in

    FreeBSD:*)
        . auto/os/freebsd
    ;;

    Linux:*)
        . auto/os/linux
    ;;

    SunOS:*)
        . auto/os/solaris
    ;;

    win32)
        CORE_INCS="$WIN32_INCS"
        CORE_DEPS="$WIN32_DEPS"
        CORE_SRCS="$WIN32_SRCS $SELECT_SRCS $IOCP_SRCS"
        EVENT_MODULES="$EVENT_MODULES $SELECT_MODULE $IOCP_MODULE"

        CFLAGS="$CFLAGS -D HAVE_AIO=1 -D HAVE_IOCP=1"
        CORE_LIBS="$CORE_LIBS ws2_32.lib"

        # msvcrt.dll
        CORE_LIBS="$CORE_LIBS msvcrt.lib"
    ;;

esac


if [ $TEST_BUILD_DEVPOLL = YES ]; then
    CFLAGS="$CFLAGS -D HAVE_DEVPOLL=1 -D TEST_BUILD_DEVPOLL=1"
    EVENT_MODULES="$EVENT_MODULES $DEVPOLL_MODULE"
    CORE_SRCS="$CORE_SRCS $DEVPOLL_SRCS"
fi

if [ $TEST_BUILD_EPOLL = YES ]; then
    CFLAGS="$CFLAGS -D HAVE_EPOLL=1 -D TEST_BUILD_EPOLL=1"
    EVENT_MODULES="$EVENT_MODULES $EPOLL_MODULE"
    CORE_SRCS="$CORE_SRCS $EPOLL_SRCS"
fi
